import pytest
from producerConsumer import *

def test_OneOperations():

    listUrl = []

    listUrl.append("https://en.wikipedia.org/wiki/Rubber_duck")
    
    output = operations(listUrl)

    assert str(output["https://en.wikipedia.org/wiki/Rubber_duck"]) == """['#bodyContent', '/wiki/Main_Page', '/wiki/Wikipedia:Contents', '/wiki/Portal:Current_events', '/wiki/Special:Random', '/wiki/Wikipedia:About', '//en.wikipedia.org/wiki/Wikipedia:Contact_us', '/wiki/Help:Contents', '/wiki/Help:Introduction', '/wiki/Wikipedia:Community_portal', '/wiki/Special:RecentChanges', '/wiki/Wikipedia:File_upload_wizard', '/wiki/Main_Page', '/wiki/Special:Search', 'https://donate.wikimedia.org/wiki/Special:FundraiserRedirector?utm_source=donate&utm_medium=sidebar&utm_campaign=C13_en.wikipedia.org&uselang=en', '/w/index.php?title=Special:CreateAccount&returnto=Rubber+duck', '/w/index.php?title=Special:UserLogin&returnto=Rubber+duck', 'https://donate.wikimedia.org/wiki/Special:FundraiserRedirector?utm_source=donate&utm_medium=sidebar&utm_campaign=C13_en.wikipedia.org&uselang=en', '/w/index.php?title=Special:CreateAccount&returnto=Rubber+duck', '/w/index.php?title=Special:UserLogin&returnto=Rubber+duck', '/wiki/Help:Introduction', '/wiki/Special:MyContributions', '/wiki/Special:MyTalk', '#', '#History', '#In_popular_culture', '#Protest_symbol', "#World's_largest_rubber_duck", '#Races', '#Scientific_studies', '#Oceanography', '#Glacial_melting', '#Germ_study', '#See_also', '#References', 'https://ar.wikipedia.org/wiki/%D8%A7%D9%84%D8%A8%D8%B7%D8%A9_%D8%A7%D9%84%D9%85%D8%B7%D8%A7%D8%B7%D9%8A%D8%A9', 'https://bg.wikipedia.org/wiki/%D0%93%D1%83%D0%BC%D0%B5%D0%BD%D0%BE_%D0%BF%D0%B0%D1%82%D0%B5', 'https://ca.wikipedia.org/wiki/%C3%80nec_de_goma', 'https://cs.wikipedia.org/wiki/Gumov%C3%A1_kachni%C4%8Dka', 'https://da.wikipedia.org/wiki/Badeand', 'https://de.wikipedia.org/wiki/Quietscheentchen', 'https://el.wikipedia.org/wiki/%CE%A0%CE%B1%CF%80%CE%AC%CE%BA%CE%B9_(%CF%80%CE%B1%CE%B9%CF%87%CE%BD%CE%AF%CE%B4%CE%B9)', 'https://es.wikipedia.org/wiki/Patito_de_goma', 'https://fr.wikipedia.org/wiki/Canard_en_plastique', 'https://ko.wikipedia.org/wiki/%EA%B3%A0%EB%AC%B4_%EC%98%A4%EB%A6%AC', 'https://hy.wikipedia.org/wiki/%D5%8C%D5%A5%D5%BF%D5%AB%D5%B6%D5%A5_%D5%A2%D5%A1%D5%A4%D5%AB%D5%AF', 'https://id.wikipedia.org/wiki/Bebek_karet', 'https://is.wikipedia.org/wiki/G%C3%BAmm%C3%AD%C3%B6nd', 'https://it.wikipedia.org/wiki/Paperella_di_gomma', 'https://he.wikipedia.org/wiki/%D7%91%D7%A8%D7%95%D7%95%D7%96_%D7%92%D7%95%D7%9E%D7%99', 'https://jv.wikipedia.org/wiki/B%C3%A8b%C3%A8k_kar%C3%A8t', 'https://la.wikipedia.org/wiki/Vicipaedia:Porta_eruditionis/Scriptorium/Anaticula_Cumminosa', 'https://hu.wikipedia.org/wiki/Gumikacsa', 'https://nl.wikipedia.org/wiki/Badeend', 'https://ja.wikipedia.org/wiki/%E3%83%A9%E3%83%90%E3%83%BC%E3%83%BB%E3%83%80%E3%83%83%E3%82%AF', 'https://no.wikipedia.org/wiki/Badeand', 'https://nn.wikipedia.org/wiki/Badeand', 'https://pl.wikipedia.org/wiki/Gumowa_kaczuszka', 'https://ru.wikipedia.org/wiki/%D0%A0%D0%B5%D0%B7%D0%B8%D0%BD%D0%BE%D0%B2%D0%B0%D1%8F_%D1%83%D1%82%D0%BE%D1%87%D0%BA%D0%B0', 'https://simple.wikipedia.org/wiki/Rubber_duck', 'https://fi.wikipedia.org/wiki/Kylpyankka', 'https://sv.wikipedia.org/wiki/Badanka', 'https://vi.wikipedia.org/wiki/V%E1%BB%8Bt_cao_su', 'https://zh-yue.wikipedia.org/wiki/%E8%86%A0%E9%B4%A8%E4%BB%94', 'https://zh.wikipedia.org/wiki/%E6%A9%A1%E7%9A%AE%E5%B0%8F%E9%B4%A8', 'https://www.wikidata.org/wiki/Special:EntityPage/Q851478#sitelinks-wikipedia', '/wiki/Rubber_duck', '/wiki/Talk:Rubber_duck', '/wiki/Rubber_duck', '/w/index.php?title=Rubber_duck&action=edit', '/w/index.php?title=Rubber_duck&action=history', '/wiki/Rubber_duck', '/w/index.php?title=Rubber_duck&action=edit', '/w/index.php?title=Rubber_duck&action=history', '/wiki/Special:WhatLinksHere/Rubber_duck', '/wiki/Special:RecentChangesLinked/Rubber_duck', '/wiki/Wikipedia:File_Upload_Wizard', '/wiki/Special:SpecialPages', '/w/index.php?title=Rubber_duck&oldid=1258961250', '/w/index.php?title=Rubber_duck&action=info', '/w/index.php?title=Special:CiteThisPage&page=Rubber_duck&id=1258961250&wpFormIdentifier=titleform', '/w/index.php?title=Special:UrlShortener&url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FRubber_duck', '/w/index.php?title=Special:QrCode&url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FRubber_duck', '/w/index.php?title=Special:DownloadAsPdf&page=Rubber_duck&action=show-download-screen', '/w/index.php?title=Rubber_duck&printable=yes', 'https://commons.wikimedia.org/wiki/Category:Rubber_ducks', 'https://www.wikidata.org/wiki/Special:EntityPage/Q851478', '/wiki/Rubber_duck_(disambiguation)', '/wiki/File:Rubber_duckies_So_many_ducks.jpg', '/wiki/Duck', '/wiki/Vinyl_plastic', '#cite_note-1', '#cite_note-2', '#cite_note-3', '/wiki/Western_World', '/wiki/Popular_culture', '/wiki/Bathing', '/wiki/Rubber_duck_race', '/w/index.php?title=Rubber_duck&action=edit&section=1', '/wiki/File:Archie_McPhee_duckies_(cropped).jpg', '/wiki/Charles_Goodyear', '/wiki/Vulcanization', '#cite_note-4', '/wiki/Peter_Ganine', '/wiki/Patent', '#cite_note-5', '/w/index.php?title=Rubba_Ducks&action=edit&redlink=1', '#cite_note-6', '/wiki/LED', '/wiki/The_Sun_(United_Kingdom)', '/wiki/Elizabeth_II', '/wiki/Crown_(headgear)', '#cite_note-7', '/wiki/Guinness_Book_of_Records', '#cite_note-8', '/wiki/National_Toy_Hall_of_Fame', '/wiki/Rochester,_New_York', '/wiki/Chess', '#cite_note-9', '#cite_note-cnn-10', '/w/index.php?title=Rubber_duck&action=edit&section=2', '/wiki/File:Grabst%C3%A4tte_Trakehner_Allee_1_(Westend)_Bernhard-Viktor_Christoph_Carl_von_B%C3%BClow2.jpg', '/wiki/Vicco_von_B%C3%BClow', '/wiki/Ernie_(Sesame_Street)', '/wiki/The_Muppets', '/wiki/Sesame_Street', '/wiki/Rubber_Duckie', '/wiki/Little_Richard', '#cite_note-11', '/wiki/C._W._McCall', '/wiki/Convoy_(song)', '/wiki/Akron_RubberDucks', '#cite_note-12', '/wiki/Goodyear_Tire_and_Rubber_Company', '/wiki/Firestone_Tire_and_Rubber_Company', '/wiki/Goodrich_Corporation', '/wiki/General_Tire', '/w/index.php?title=Rubber_duck&action=edit&section=3', '/wiki/Belgrade', '/wiki/Brazil', '/wiki/Moscow', '#cite_note-13', '/wiki/Bangkok', '#cite_note-14', '/w/index.php?title=Rubber_duck&action=edit&section=4', '/wiki/Rubber_Duck_(sculpture)', '/wiki/Florentijn_Hofman', '#cite_note-15', '#cite_note-hk.lifestyle.yahoo.com-16', '#cite_note-17', '#cite_note-18', '/wiki/Great_Firewall', '/wiki/Internet_censorship_in_China', '/wiki/Rubber_Duck_(sculpture)#Censorship', '/wiki/Tank_Man', '/wiki/Tiananmen_Square_Massacre', '#cite_note-19', '/w/index.php?title=Rubber_duck&action=edit&section=5', '/wiki/File:Entenrennen_auf_der_Dreisam_in_Freiburg,_Plastikenten_an_der_Leo-Wohleb-Br%C3%BCcke.jpg', '/wiki/Freiburg_im_Breisgau', '/wiki/Germany', '/wiki/Rubber_duck_race', '/wiki/Rubber_duck_race', '/w/index.php?title=Rubber_duck&action=edit&section=6', '/w/index.php?title=Rubber_duck&action=edit&section=7', '/wiki/Friendly_Floatees', '/wiki/Friendly_Floatees', '#cite_note-NationalMena-20', '#cite_note-21', '/wiki/North_Pacific_Gyre', '/wiki/Great_Pacific_Garbage_Patch', '/wiki/Bering_Strait', '/wiki/Alaska', '/wiki/Arctic', '/wiki/Atlantic_Ocean', '/wiki/Oceanographer', '/wiki/Curtis_Ebbesmeyer', '#cite_note-cbs-22', '/wiki/Savings_bond', '/wiki/New_England', '/wiki/Donovan_Hohn', '/wiki/Moby-Duck', '/w/index.php?title=Rubber_duck&action=edit&section=8', '/wiki/NASA', '/wiki/Jet_Propulsion_Laboratory', '/wiki/Greenland', '/wiki/Jakobshavn_Glacier', '/wiki/Moulin_(geomorphology)', '/wiki/Baffin_Bay', '#cite_note-23', '#cite_note-24', '#cite_note-25', '/w/index.php?title=Rubber_duck&action=edit&section=9', '#cite_note-26', '/w/index.php?title=Rubber_duck&action=edit&section=10', 'https://commons.wikimedia.org/wiki/Category:Rubber_ducks', '/wiki/Hook-a-duck', '/wiki/Rubber_duck_debugging', '/w/index.php?title=Rubber_duck&action=edit&section=11', '#cite_ref-1', 'http://www.toyhalloffame.org/toys/rubber-duck', '#cite_ref-2', 'https://www.stneotsmuseum.org.uk/articles/the-history-of-the-rubber-duck/', '#cite_ref-3', 'https://www.toyhalloffame.org/toys/rubber-duck', '#cite_ref-4', 'http://www.toyhalloffame.org/toys/rubber-duck', '#cite_ref-5', '/wiki/Los_Angeles_Times', '#cite_ref-6', '#cite_ref-7', 'http://news.bbc.co.uk/cbbcnews/hi/uk/newsid_1581000/1581293.stm', '#cite_ref-8', 'http://www.guinnessworldrecords.com/world-records/largest-collection-of-rubber-ducks', '#cite_ref-9', 'http://www.latimes.com/nation/la-sh-toy-hall-of-fame-rubber-duck-chess-20131107-story.html', '#cite_ref-cnn_10-0', 'https://www.cnn.com/2013/11/07/living/national-toy-hall-of-fame-2013/index.html', '#cite_ref-11', 'https://www.youtube.com/watch?v=tWCEG6lV0ek', '/wiki/Children%27s_Television_Workshop', '#cite_ref-12', 'https://www.milb.com/news/gcs-63448892', '#cite_ref-13', 'https://www.bloomberg.com/opinion/articles/2017-03-28/the-yellow-rubber-duck-is-a-potent-protest-symbol', '#cite_ref-14', 'https://www.scmp.com/photos/3112420/yellow-rubber-duck-becomes-symbol-thai-protests', '#cite_ref-15', 'http://www.standaard.be/cnt/DMF20130502_00563759', '#cite_ref-hk.lifestyle.yahoo.com_16-0', 'http://hk.lifestyle.yahoo.com/6%E5%80%8B%E4%B8%8D%E5%8F%AF%E4%B8%8D%E7%9F%A5%E7%9A%84rubber-duck%E8%A7%A3%E7%A2%BC-112521565.html;_ylt=AnAH5UFScqvUJl6_3qby4m6W6mJH;_ylu=X3oDMTNob2FuNWRpBG1pdANkdWNrbmV3cwRwa2cDMmY0OWY3NjctOTk2Ni0zNGRiLWE5MmYtN2E2N2FjYzRlZDFmBHBvcwMzBHNlYwNtZWdhdHJvbgR2ZXIDYTExYTM3ZTAtYWUyMS0xMWUyLWJiYjYtNDRjNWExN2FkZjkz;_ylg=X3oDMTFqY2k4Y2lnBGludGwDaGsEbGFuZwN6aC1oYW50LWhrBHBzdGFpZAMEcHN0Y2F0AwRwdANzZWN0aW9ucw--;_ylv=3', '#cite_ref-17', 'http://www.nextstophongkong.com/2013/05/first-day-of-florentijn-hofmans-rubber-duck-exhibition-in-hong-kong/', '#cite_ref-18', 'https://abcnews.go.com/Weird/wireStory/giant-rubber-duck-makes-splash-hong-kong-harbor-19098462#.UYP2KSvwLuE', '#cite_ref-19', 'http://rendezvous.blogs.nytimes.com/2013/06/04/censored-in-china-today-tonight-and-big-yellow-duck/', '#cite_ref-NationalMena_20-0', 'https://www.thenationalnews.com/mena_edition/mena/egypt/what-connects-the-ever-given-the-suez-canal-and-7200-rubber-ducks-loose-in-the-pacific-1.1191975', '/wiki/The_National_(Abu_Dhabi)', '#cite_ref-21', 'https://web.archive.org/web/20061005100806/http://www.agu.org/sci_soc/ducks.html', '/wiki/Bibcode_(identifier)', 'https://ui.adsabs.harvard.edu/abs/1994EOSTr..75..425E', '/wiki/Doi_(identifier)', 'https://doi.org/10.1029%2F94EO01056', 'http://www.agu.org/sci_soc/ducks.html', '#cite_ref-cbs_22-0', 'https://www.cbsnews.com/news/rubber-duckies-map-the-world/', '#cite_ref-23', 'https://www.reuters.com/article/us-climate-glacier-idUSN1746514020080921?feedType=RSS&feedName=environmentNews&pageNumber=1&virtualBrandChannel=0', '/wiki/Reuters', '#cite_ref-24', 'https://web.archive.org/web/20140310135419/http://www.nbcnews.com/id/26857674/ns/us_news-environment/t/rubber-duckies-rescue-glacier-research/', '/wiki/NBC_News', 'http://www.nbcnews.com/id/26857674/ns/us_news-environment/t/rubber-duckies-rescue-glacier-research/', '#cite_ref-25', 'http://www.latimes.com/science/sciencenow/la-sci-sn-catastrophic-greenland-melt-20150112-story.html', '/wiki/Los_Angeles_Times', '#cite_ref-26', 'https://pubs.rsc.org/en/content/articlehtml/2019/ew/c9ew90008j', '/wiki/Doi_(identifier)', 'https://doi.org/10.1039%2FC9EW90008J', '/wiki/S2CID_(identifier)', 'https://api.semanticscholar.org/CorpusID:159043529', 'https://en.wikipedia.org/w/index.php?title=Rubber_duck&oldid=1258961250', '/wiki/Help:Category', '/wiki/Category:Bathing', '/wiki/Category:Charity_fundraisers', '/wiki/Category:Rubber_toys', '/wiki/Category:Toy_animals', '/wiki/Category:Traditional_toys', '/wiki/Category:Water_toys', '/wiki/Category:Ducks_in_popular_culture', '/wiki/Category:Articles_with_short_description', '/wiki/Category:Short_description_matches_Wikidata', '/wiki/Category:Use_dmy_dates_from_January_2020', '/wiki/Category:Commons_category_link_is_on_Wikidata', '/wiki/Wikipedia:Text_of_the_Creative_Commons_Attribution-ShareAlike_4.0_International_License', 'https://foundation.wikimedia.org/wiki/Special:MyLanguage/Policy:Terms_of_Use', 'https://foundation.wikimedia.org/wiki/Special:MyLanguage/Policy:Privacy_policy', 'https://wikimediafoundation.org/', 'https://foundation.wikimedia.org/wiki/Special:MyLanguage/Policy:Privacy_policy', '/wiki/Wikipedia:About', '/wiki/Wikipedia:General_disclaimer', '//en.wikipedia.org/wiki/Wikipedia:Contact_us', 'https://foundation.wikimedia.org/wiki/Special:MyLanguage/Policy:Universal_Code_of_Conduct', 'https://developer.wikimedia.org', 'https://stats.wikimedia.org/#/en.wikipedia.org', 'https://foundation.wikimedia.org/wiki/Special:MyLanguage/Policy:Cookie_statement', '//en.m.wikipedia.org/w/index.php?title=Rubber_duck&mobileaction=toggle_view_mobile', 'https://wikimediafoundation.org/', 'https://www.mediawiki.org/']"""


def test_OneOperationsURL_Error():

    listUrl = []

    listUrl.append("https://en.wikipedia.org/wiki/Rubber_duck/__IMPLANTED_ERROR")
    
    output = operations(listUrl)

    assert len(output.items()) == 0

def test_Eight_Operations():

    listUrl = []

    listUrl.append("https://en.wikipedia.org/wiki/Rubber_duck")
    listUrl.append("https://en.wikipedia.org/wiki/London")
    listUrl.append("https://en.wikipedia.org/wiki/New_York_City")
    listUrl.append("https://en.wikipedia.org/wiki/Berlin")
    listUrl.append("https://en.wikipedia.org/wiki/Paris")
    listUrl.append("https://en.wikipedia.org/wiki/Mumbai")
    listUrl.append("https://en.wikipedia.org/wiki/Tokyo")
    listUrl.append("https://en.wikipedia.org/wiki/Shenzhen")
    listUrl.append("https://en.wikipedia.org/wiki/San_Francisco")

    output = operations(listUrl)

    assert len(output["https://en.wikipedia.org/wiki/Rubber_duck"]) > 0
    assert len(output["https://en.wikipedia.org/wiki/Mumbai"]) > 0
    assert len(output["https://en.wikipedia.org/wiki/San_Francisco"]) > 0


def test_TwoOperationsURL_Error():

    listUrl = []

    listUrl.append("https://en.wikipedia.org/wiki/London")
    listUrl.append("https://en.wikipedia.org/wiki/Rubber_duck/__IMPLANTED_ERROR")
    
    output = operations(listUrl)

    assert len(output.items()) == 1


def test_TwoOperationsURL_TwoError():

    listUrl = []

    listUrl.append("https://en.wikipedia.org/wiki/New_York_City_IMPLANTED_ERROR")
    listUrl.append("https://en.wikipedia.org/wiki/London")
    listUrl.append("https://en.wikipedia.org/wiki/Rubber_duck/__IMPLANTED_ERROR")
    
    output = operations(listUrl)

    assert len(output.items()) == 1
